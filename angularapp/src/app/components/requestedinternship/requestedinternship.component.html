<div class="container">
  <h1>Internship Applications for Approval</h1>

  <!-- Search and Filter -->
  <div class="search-filter">
    <input
      type="text"
      placeholder="Search by Degree Program"
      [(ngModel)]="degreeProgramSearch"
      (input)="searchAndFilter()"
    />
    <label>Filter by Status</label>
    <select [(ngModel)]="statusFilter" (change)="searchAndFilter()">
      <option value="">All</option>
      <option value="Pending">Pending</option>
      <option value="Approved">Approved</option>
      <option value="Rejected">Rejected</option>
    </select>
  </div>

  <!-- No Records Found -->
  <div *ngIf="filteredApplications.length === 0" class="no-records">
    <h2>Oops! No records Found</h2>
  </div>

  <!-- Applications Table -->
  <div *ngIf="filteredApplications.length > 0">
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>S.No</th>
          <th>Username</th>
          <th>University Name</th>
          <th>Degree Program</th>
          <th>Application Date</th>
          <th>LinkedIn Profile</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let application of filteredApplications; let i = index">
          <td>{{ application.SNo }}</td>
          <td>{{ application.Username }}</td>
          <td>{{ application.UniversityName }}</td>
          <td>{{ application.DegreeProgram }}</td>
          <td>{{ application.ApplicationDate }}</td>
          <td>
            <a *ngIf="application.LinkedInProfile" [href]="application.LinkedInProfile" target="_blank">
              View LinkedIn
            </a>
          </td>
          <td>{{ application.Status }}</td>
          <td>
            <!-- Approve Button: Disappears only after approval -->
            <button *ngIf="application.Status !== 'Approved'" class="btn btn-success" (click)="approveApplication(i)">
              Approve
            </button>

            <!-- Reject Button: Disappears only after rejection -->
            <button *ngIf="application.Status !== 'Rejected'" class="btn btn-danger reject-btn" (click)="rejectApplication(i)">
              Reject
            </button>

            <button class="btn btn-primary" (click)="viewResume(application.Resume)">
              View Resume
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Resume Popup -->
  <div *ngIf="selectedResume" class="popup">
    <div class="popup-content">
      <iframe [src]="selectedResume | safeUrl" width="100%" height="500px"></iframe>
      <button class="btn btn-secondary" (click)="closePopup()">Close</button>
    </div>
  </div>

  <!-- View Degree Program Chart Button -->
  <div class="chart-btn">
    <button class="btn btn-info" (click)="viewDegreeProgramChart()">View Degree Program Chart</button>
  </div>
</div>
