<div class="container">
  <h1>Internship Applications for Approval</h1>

  <!-- Search and Filter -->
  <div class="search-filter">
    <input type="text" placeholder="Search by Degree Program" [(ngModel)]="degreeProgramSearch" (input)="searchAndFilter()" />
    <label>Filter by Status</label>
    <select [(ngModel)]="statusFilter" (change)="searchAndFilter()">
      <option value="">All</option>
      <option value="Pending">Pending</option>
      <option value="Approved">Approved</option>
      <option value="Rejected">Rejected</option>
    </select>
  </div>

  <!-- No Records Found -->
  <div *ngIf="filteredApplications.length === 0" class="no-records">
    <h2>Oops! No records Found</h2>
  </div>

  <!-- Applications Table -->
  <div *ngIf="filteredApplications.length > 0">
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>S.No</th>
          <th>Username</th>
          <th>University Name</th>
          <th>Degree Program</th>
          <th>Application Date</th>
          <th>LinkedIn Profile</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let application of filteredApplications; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ application.username }}</td>
          <td>{{ application.universityName }}</td>
          <td>{{ application.degreeProgram }}</td>
          <td>{{ application.applicationDate }}</td>
          <td>
            <a *ngIf="application.linkedInProfile" [href]="application.linkedInProfile" target="_blank">View LinkedIn</a>
          </td>
          <td>{{ application.status }}</td>
          <td>
            <!-- Approve Button -->
            <button *ngIf="application.status !== 'Approved'" class="btn btn-success" (click)="approveApplication(i)">Approve</button>
            
            <!-- Reject Button -->
            <button *ngIf="application.status !== 'Rejected'" class="btn btn-danger" (click)="rejectApplication(i)">Reject</button>

            <!-- View Resume Button -->
            <button class="btn btn-primary" (click)="viewResume(application.resumeUrl)">View Resume</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Resume Popup (Supports PNG & TXT) -->
  <div *ngIf="selectedResumeUrl" class="popup">
    <div class="popup-content">
      <!-- View TXT Resumes -->
      <iframe *ngIf="selectedResumeUrl.endsWith('.txt')" [src]="selectedResumeUrl | safeUrl" width="100%" height="500px"></iframe>
      
      <!-- View PNG Resumes -->
      <img *ngIf="selectedResumeUrl.endsWith('.png')" [src]="selectedResumeUrl" alt="Resume Image" width="100%" />
      
      <button class="btn btn-secondary" (click)="closePopup()">Close</button>
    </div>
  </div>

  <!-- View Degree Program Chart -->
  <div class="chart-btn">
    <button class="btn btn-info" (click)="viewDegreeProgramChart()">View Degree Program Chart</button>
  </div>
</div>
